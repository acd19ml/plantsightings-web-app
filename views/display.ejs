<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel='stylesheet' href='/stylesheets/display.css' />
</head>
<body>
<div class="container">
    <h1 class="text-center"><%= title %></h1>
    <br>
    <!-- Photo at the top -->
    <div class="mb-3 text-center">
        <img src="/<%= plantsighting.photo %>" width="300" alt="Current Photo">
    </div>
    <div class="row">
        <!-- first column -->
        <div class="col-md-5">
            <!-- nickname -->
            <div class="mb-3">
                <label class="form-label">Nickname:</label>
                <input class="form-control" type="text" value="<%= plantsighting.nickname %>" readonly>
            </div>
            <!-- date -->
            <div class="mb-3">
                <label class="form-label">Date Seen:</label>
                <input class="form-control" type="text" value="<%= plantsighting.dateSeen.toISOString().split('T')[0] %>" readonly>
            </div>
            <!-- location -->
            <div class="mb-3">
                <label class="form-label">Location (Longitude, Latitude):</label>
                <input class="form-control" type="text" value="<%= plantsighting.location.coordinates.join(', ') %>" readonly>
            </div>
            <!-- identification status -->
            <div class="mb-3">
                <label class="form-label">Identification Status:</label>
                <input class="form-control" type="text" value="<%= plantsighting.identification.status %>" readonly>
            </div>
        </div>
        <!-- second column -->
        <div class="col-md-7">
            <div class="row g-3">
                <!-- height -->
                <div class="col-sm-6">
                    <label class="form-label">Plant Height:</label>
                    <input class="form-control" type="text" value="<%= plantsighting.plantSize.height %> meters" readonly>
                </div>
                <!-- spread -->
                <div class="col-sm-6">
                    <label class="form-label">Plant Spread:</label>
                    <input class="form-control" type="text" value="<%= plantsighting.plantSize.spread %> meters" readonly>
                </div>
            </div><br>
            <!-- description -->
            <div class="mb-3">
                <label class="form-label">Description:</label>
                <textarea class="form-control" rows="5" readonly><%= plantsighting.description %></textarea>
            </div>
            <!-- plant characteristics -->
            <div class="mb-3">
                <label class="form-label">Plant Characteristics:</label>
                <div class="form-check">    <!-- check if selected -->
                    <input class="form-check-input" type="checkbox" id="flowers" disabled <%= plantsighting.plantCharacteristics.flowers ? 'checked' : '' %>>
                    <label class="form-check-label" for="flowers">Flowers</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="leaves" disabled <%= plantsighting.plantCharacteristics.leaves ? 'checked' : '' %>>
                    <label class="form-check-label" for="leaves">Leaves</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="fruitsOrSeeds" disabled <%= plantsighting.plantCharacteristics.fruitsOrSeeds ? 'checked' : '' %>>
                    <label class="form-check-label" for="fruitsOrSeeds">Fruits or Seeds</label>
                </div>
            </div>
            <!-- sun exposure -->
            <div class="mb-3">
                <label class="form-label">Sun Exposure:</label>
                <input class="form-control" type="text" value="<%= plantsighting.plantCharacteristics.sunExposure %>" readonly>
            </div>
        </div>
    </div>
    <div class="mb-3 text-center">
        <a class="btn btn-secondary" href="/">Back</a>
        <a class="btn btn-primary" href="/display/<%= plantsighting._id %>/edit">Edit</a>
    </div>

</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var storedNickname = JSON.parse(localStorage.getItem('nickname'));
        // Ensure both are strings and trim any whitespace
        var localNickname = storedNickname ? storedNickname.trim() : '';
        var serverNickname = "<%= plantsighting.nickname %>".trim();

        // Optionally, convert both to lowercase to ignore case differences
        localNickname = localNickname.toLowerCase();
        serverNickname = serverNickname.toLowerCase();
        console.log("Local Nickname: ", localNickname);
        console.log("Server Nickname: ", serverNickname);

        if (localNickname !== serverNickname || localNickname === '') {
            var message = "The nickname does not match or is not set. You will be redirected to the homepage.";

            // Create a div element to display the message
            var messageDiv = document.createElement('div');
            messageDiv.style.position = 'fixed';
            messageDiv.style.left = '0';
            messageDiv.style.right = '0';
            messageDiv.style.top = '0';
            messageDiv.style.backgroundColor = 'red';
            messageDiv.style.color = 'white';
            messageDiv.style.textAlign = 'center';
            messageDiv.style.padding = '10px';
            messageDiv.style.fontSize = '20px';
            messageDiv.style.zIndex = '1000';
            messageDiv.innerText = message;

            // Append the message div to the body
            document.body.appendChild(messageDiv);

            setTimeout(function() {
                window.location.href = '/';
            }, 5000);
        }
    });
</script>
</body>
</html>
