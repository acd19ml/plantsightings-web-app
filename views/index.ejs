<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel='stylesheet' href='/stylesheets/style.css' />
</head>
<body>
<h1><%= title %></h1>

<!-- Sort Dropdown Menu -->
<div class="container">
    <div class="row">
        <div class="col">
            <form action="/" method="GET" id="sortForm">
                <div class="form-group">
                    <label for="sortOrder">Sort By:</label>
                    <select name="sortOrder" id="sortOrder" class="form-control" onchange="handleSortChange(this)">
                        <option value="newest" <%= sortOrder === 'newest' ? 'selected' : '' %>>Date (Newest)</option>
                        <option value="oldest" <%= sortOrder === 'oldest' ? 'selected' : '' %>>Date (Oldest)</option>
                        <option value="distance" <%= sortOrder === 'distance' ? 'selected' : '' %>>Distance</option>
                    </select>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Plant Sightings Display -->
<div class="container">
    <div class="row">
        <% data.forEach(plantsighting => { %>
            <div class="col-sm-6 col-md-4 col-lg-3">
                <a href="/display/<%= plantsighting._id %>"><img src="<%= plantsighting.photo %>" class="img-thumbnail" width="200" height="200" alt="Plant Photo"></a>
                <p><strong>Date Seen:</strong> <%= plantsighting.dateSeen.toDateString() %></p>
                <% if (plantsighting.location && plantsighting.location.coordinates) { %>
                    <!-- Hidden latitude and longitude -->
                    <span style="display: none;" id="lat_<%= plantsighting._id %>"><%= plantsighting.location.coordinates[1] %></span>
                    <span style="display: none;" id="long_<%= plantsighting._id %>"><%= plantsighting.location.coordinates[0] %></span>
                <% } %>
                <% if (sortOrder === 'distance' && plantsighting.distance != null) { %>
                    <p><strong>Distance:</strong> <%= plantsighting.distance.toFixed(2) + ' km' %></p>
                <% } %>
            </div>
        <% }); %>
    </div>
</div>
<hr>
<a href="/add"><p>Add New Plant Sighting</p></a>
</body>
<script src="/javascripts/distance.js"></script>
</html>



